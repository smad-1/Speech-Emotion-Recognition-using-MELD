(venv_hubert) (base) bio@cse-System-Product-Name:~/SMS/clone/Speech-Emotion-Recognition-using-MELD$ python hubert_reg.py
✅ Dataset loaded. Train size: 6453
Some weights of HubertForSequenceClassification were not initialized from the model checkpoint at facebook/hubert-base-ls960 and are newly initialized: ['classifier.bias', 'classifier.weight', 'projector.bias', 'projector.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
/home/bio/SMS/clone/Speech-Emotion-Recognition-using-MELD/hubert_reg.py:121: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
🚀 Starting HuBERT training with regularization (v2)...
 10%|███████████▉                                                                                                            | 403/4040 [01:35<15:18,  3.96it/s][UnfreezeCallback] Unfroze last 2 encoder layers at epoch 1.
{'loss': 1.8836, 'grad_norm': 1.1186240911483765, 'learning_rate': 4.03e-06, 'epoch': 1.0}                                                                      
 10%|████████████                                                                                                            | 404/4040 [01:35<15:18,  3.96it/s/home/bio/SMS/clone/Speech-Emotion-Recognition-using-MELD/venv_hubert/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
{'eval_loss': 1.7544244527816772, 'eval_accuracy': 0.7247706422018348, 'eval_f1': 0.6091157524887761, 'eval_precision': 0.5252924837976601, 'eval_recall': 0.7247706422018348, 'eval_runtime': 2.8955, 'eval_samples_per_second': 150.581, 'eval_steps_per_second': 18.995, 'epoch': 1.0}                                       
{'loss': 1.5762, 'grad_norm': 2.8971290588378906, 'learning_rate': 4.9077870518726154e-06, 'epoch': 2.0}                                                        
 20%|████████████████████████                                                                                                | 808/4040 [03:19<12:49,  4.20it/s/home/bio/SMS/clone/Speech-Emotion-Recognition-using-MELD/venv_hubert/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
{'eval_loss': 1.374709129333496, 'eval_accuracy': 0.7247706422018348, 'eval_f1': 0.6091157524887761, 'eval_precision': 0.5252924837976601, 'eval_recall': 0.7247706422018348, 'eval_runtime': 2.7894, 'eval_samples_per_second': 156.306, 'eval_steps_per_second': 19.718, 'epoch': 2.0}                                        
 30%|███████████████████████████████████▋                                                                                   | 1211/4040 [05:01<13:09,  3.58it/s][UnfreezeCallback] Unfroze all encoder layers at epoch 3.                                                                                                       
{'loss': 1.2569, 'grad_norm': 1.778141975402832, 'learning_rate': 4.51862307283354e-06, 'epoch': 3.0}                                                           
 30%|███████████████████████████████████▋                                                                                   | 1212/4040 [05:01<13:09,  3.58it/s/home/bio/SMS/clone/Speech-Emotion-Recognition-using-MELD/venv_hubert/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
{'eval_loss': 1.1408663988113403, 'eval_accuracy': 0.7247706422018348, 'eval_f1': 0.6091157524887761, 'eval_precision': 0.5252924837976601, 'eval_recall': 0.7247706422018348, 'eval_runtime': 2.7989, 'eval_samples_per_second': 155.777, 'eval_steps_per_second': 19.651, 'epoch': 3.0}                                       
{'loss': 1.1038, 'grad_norm': 4.15486478805542, 'learning_rate': 3.872742475060895e-06, 'epoch': 4.0}                                                           
 40%|███████████████████████████████████████████████▌                                                                       | 1616/4040 [07:11<12:16,  3.29it/s/home/bio/SMS/clone/Speech-Emotion-Recognition-using-MELD/venv_hubert/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
{'eval_loss': 1.0675370693206787, 'eval_accuracy': 0.7247706422018348, 'eval_f1': 0.6091157524887761, 'eval_precision': 0.5252924837976601, 'eval_recall': 0.7247706422018348, 'eval_runtime': 2.7923, 'eval_samples_per_second': 156.146, 'eval_steps_per_second': 19.697, 'epoch': 4.0}                                       
{'loss': 1.0368, 'grad_norm': 6.932047367095947, 'learning_rate': 3.052284557068229e-06, 'epoch': 5.0}                                                          
 50%|███████████████████████████████████████████████████████████▌                                                           | 2020/4040 [09:23<08:32,  3.94it/s/home/bio/SMS/clone/Speech-Emotion-Recognition-using-MELD/venv_hubert/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
{'eval_loss': 1.0262938737869263, 'eval_accuracy': 0.7247706422018348, 'eval_f1': 0.6091157524887761, 'eval_precision': 0.5252924837976601, 'eval_recall': 0.7247706422018348, 'eval_runtime': 2.6648, 'eval_samples_per_second': 163.614, 'eval_steps_per_second': 20.639, 'epoch': 5.0}                                       
{'loss': 0.9996, 'grad_norm': 2.4995064735412598, 'learning_rate': 2.1615903349445964e-06, 'epoch': 6.0}                                                        
 60%|███████████████████████████████████████████████████████████████████████▍                                               | 2424/4040 [11:34<09:11,  2.93it/s/home/bio/SMS/clone/Speech-Emotion-Recognition-using-MELD/venv_hubert/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
{'eval_loss': 0.9998089075088501, 'eval_accuracy': 0.7247706422018348, 'eval_f1': 0.6091157524887761, 'eval_precision': 0.5252924837976601, 'eval_recall': 0.7247706422018348, 'eval_runtime': 2.6586, 'eval_samples_per_second': 163.997, 'eval_steps_per_second': 20.688, 'epoch': 6.0}                                       
{'loss': 0.9687, 'grad_norm': 2.7551119327545166, 'learning_rate': 1.3139330651519584e-06, 'epoch': 7.0}                                                        
 70%|███████████████████████████████████████████████████████████████████████████████████▎                                   | 2828/4040 [13:45<06:25,  3.15it/s/home/bio/SMS/clone/Speech-Emotion-Recognition-using-MELD/venv_hubert/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
{'eval_loss': 0.9847444295883179, 'eval_accuracy': 0.7247706422018348, 'eval_f1': 0.6091157524887761, 'eval_precision': 0.5252924837976601, 'eval_recall': 0.7247706422018348, 'eval_runtime': 2.6655, 'eval_samples_per_second': 163.572, 'eval_steps_per_second': 20.634, 'epoch': 7.0}                                       
{'loss': 0.9665, 'grad_norm': 3.7905704975128174, 'learning_rate': 6.171128174877145e-07, 'epoch': 8.0}                                                         
 80%|███████████████████████████████████████████████████████████████████████████████████████████████▏                       | 3232/4040 [15:54<04:30,  2.99it/s/home/bio/SMS/clone/Speech-Emotion-Recognition-using-MELD/venv_hubert/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
{'eval_loss': 0.9767712950706482, 'eval_accuracy': 0.7247706422018348, 'eval_f1': 0.6091157524887761, 'eval_precision': 0.5252924837976601, 'eval_recall': 0.7247706422018348, 'eval_runtime': 2.661, 'eval_samples_per_second': 163.847, 'eval_steps_per_second': 20.669, 'epoch': 8.0}                                        
{'loss': 0.9634, 'grad_norm': 5.8555707931518555, 'learning_rate': 1.5974709576071e-07, 'epoch': 9.0}                                                           
 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████            | 3636/4040 [18:03<02:09,  3.11it/s/home/bio/SMS/clone/Speech-Emotion-Recognition-using-MELD/venv_hubert/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
{'eval_loss': 0.9738160371780396, 'eval_accuracy': 0.7247706422018348, 'eval_f1': 0.6091157524887761, 'eval_precision': 0.5252924837976601, 'eval_recall': 0.7247706422018348, 'eval_runtime': 2.6648, 'eval_samples_per_second': 163.614, 'eval_steps_per_second': 20.639, 'epoch': 9.0}                                       
{'loss': 0.9529, 'grad_norm': 3.643970012664795, 'learning_rate': 9.844716311602221e-13, 'epoch': 10.0}                                                         
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4040/4040 [20:12<00:00,  3.47it/s/home/bio/SMS/clone/Speech-Emotion-Recognition-using-MELD/venv_hubert/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
{'eval_loss': 0.9733966588973999, 'eval_accuracy': 0.7247706422018348, 'eval_f1': 0.6091157524887761, 'eval_precision': 0.5252924837976601, 'eval_recall': 0.7247706422018348, 'eval_runtime': 2.6683, 'eval_samples_per_second': 163.4, 'eval_steps_per_second': 20.612, 'epoch': 10.0}                                        
{'train_runtime': 1215.6507, 'train_samples_per_second': 53.083, 'train_steps_per_second': 3.323, 'train_loss': 1.170855999937152, 'epoch': 10.0}               
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4040/4040 [20:15<00:00,  3.32it/s]
📊 Evaluating on test set...
 99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎ | 137/139 [00:07<00:00, 16.97it/s]/home/bio/SMS/clone/Speech-Emotion-Recognition-using-MELD/venv_hubert/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:07<00:00, 17.86it/s]
📊 Final test results: {'eval_loss': 0.9045074582099915, 'eval_accuracy': 0.7529305680793508, 'eval_f1': 0.6468076382163147, 'eval_precision': 0.5669044403482938, 'eval_recall': 0.7529305680793508, 'eval_runtime': 7.8271, 'eval_samples_per_second': 141.687, 'eval_steps_per_second': 17.759, 'epoch': 10.0}
📝 Saving predictions...
 99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎ | 137/139 [00:07<00:00, 16.93it/s]/home/bio/SMS/clone/Speech-Emotion-Recognition-using-MELD/venv_hubert/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:07<00:00, 17.90it/s]
✅ Predictions saved to results_hubert_v2/hubert_predictions_v2.csv